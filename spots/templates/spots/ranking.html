{% extends 'spots/base.html' %}

{% block title %}ランキング - 旅ログマップ{% endblock %}

{% block content %}
<div class="d-flex align-items-center mb-3">
  <h2 class="me-3"><i class="fas fa-trophy text-warning me-2"></i>ランキング</h2>
  <span class="text-muted">直近7日間の閲覧数</span>
  <div class="ms-auto small text-muted">集計開始: {{ week_ago|date:"Y/m/d H:i" }}</div>
  </div>

{% if ranked_spots %}
  <div class="row g-3">
    {% for spot in ranked_spots %}
      <div class="col-12">
        <div class="card shadow-sm">
          <div class="card-body d-flex align-items-center">
            <div class="display-6 fw-bold me-3" style="width: 3rem; text-align:center;">
              {{ forloop.counter }}
            </div>
            {% if spot.image_src %}
              <img src="{{ spot.image_src }}" alt="{{ spot.title }}" class="me-3 rounded" style="width: 72px; height: 72px; object-fit: cover;">
            {% endif %}
            <div class="flex-grow-1">
              <h5 class="mb-1"><a href="{% url 'spot_detail' spot.id %}" class="text-decoration-none">{{ spot.title }}</a></h5>
              {% if spot.address %}<div class="text-muted small"><i class="fas fa-map-marker-alt me-1"></i>{{ spot.address }}</div>{% endif %}
              {% if spot.tags.all %}
                <div class="mt-1">
                  {% for tag in spot.tags.all %}
                    <span class="badge bg-light text-dark border me-1">#{{ tag.name }}</span>
                  {% endfor %}
                </div>
              {% endif %}
            </div>
            <div class="text-end" style="width: 8rem;">
              <div class="fw-bold"><i class="far fa-eye me-1"></i>{{ spot.weekly_views }} 回</div>
              <div class="text-muted small">過去7日</div>
            </div>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
  <div class="text-center py-5">
    <i class="far fa-eye-slash fa-4x text-muted mb-3"></i>
    <p class="mb-0">直近7日間の閲覧データがありません。</p>
  </div>
{% endif %}
{% endblock %}

