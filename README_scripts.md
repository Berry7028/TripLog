# é–‹ç™ºç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¬ã‚¤ãƒ‰

TripLog ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®é–‹ç™ºãƒ•ãƒ­ãƒ¼ã‚’ã¾ã¨ã‚ã¦æ”¯æ´ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆç¾¤ã«ã¤ã„ã¦è§£èª¬ã—ã¾ã™ã€‚æœ€æ–°ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã¯ `scripts/devhub/devhub.sh` ã§ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç¾åœ¨çŠ¶æ³ã‚’è¡¨ç¤ºã—ãªãŒã‚‰å„ç¨®ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’èµ·å‹•ã§ãã¾ã™ã€‚

## ğŸ“ ã‚¹ã‚¯ãƒªãƒ—ãƒˆæ§‹æˆ

```
TripLog/
â”œâ”€â”€ start.sh                  # devhub ã¸ã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹
â””â”€â”€ scripts/
    â”œâ”€â”€ devhub/
    â”‚   â””â”€â”€ devhub.sh         # é–‹ç™ºãƒãƒ– (æƒ…å ±è¡¨ç¤º + å„ç¨®ã‚¹ã‚¯ãƒªãƒ—ãƒˆå‘¼ã³å‡ºã—)
    â”œâ”€â”€ start_server.sh       # æ—¢å­˜ç’°å¢ƒã§ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•
    â”œâ”€â”€ dev_start.sh          # ä»®æƒ³ç’°å¢ƒæ§‹ç¯‰ã‹ã‚‰ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ã¾ã§
    â”œâ”€â”€ ai_generate_spots.sh  # AI ã‚’ä½¿ã£ãŸã‚¹ãƒãƒƒãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
    â””â”€â”€ flow/
        â””â”€â”€ generate_flow.py  # ç”»é¢ãƒ•ãƒ­ãƒ¼å›³ã‚’ç”Ÿæˆ
```

## ğŸš€ æ¨å¥¨ã®ä½¿ã„æ–¹

### å¯¾è©±çš„ãªé–‹ç™ºãƒãƒ–ã‚’èµ·å‹•ã™ã‚‹

```bash
./start.sh            # ã¾ãŸã¯ ./scripts/devhub/devhub.sh menu
```

`devhub.sh` ã¯èµ·å‹•æ™‚ã«ä»¥ä¸‹ã®æƒ…å ±ã‚’ã¾ã¨ã‚ã¦è¡¨ç¤ºã—ã¾ã™ã€‚

- Git ãƒ–ãƒ©ãƒ³ãƒã¨å¤‰æ›´çŠ¶æ³
- venv/ ã® Python ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨ pip ãƒãƒ¼ã‚¸ãƒ§ãƒ³
- Django ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŠã‚ˆã³ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨ˆç”» (`showmigrations --plan`)
- å‘¼ã³å‡ºã—å¯èƒ½ãªã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆä¸€è¦§

ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§é¸æŠã§ãã‚‹å†…å®¹:

1. æƒ…å ±ã®å†è¡¨ç¤º
2. é–‹ç™ºã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— (`dev_start.sh`)
3. ã‚µãƒ¼ãƒãƒ¼èµ·å‹• (`start_server.sh`)
4. AI ã‚¹ãƒãƒƒãƒˆç”Ÿæˆ (`ai_generate_spots.sh`)
5. ç”»é¢ãƒ•ãƒ­ãƒ¼å›³ç”Ÿæˆ (`flow/generate_flow.py`)
0. çµ‚äº†

### CLI ã‹ã‚‰ç›´æ¥ã‚³ãƒãƒ³ãƒ‰ã‚’æŒ‡å®šã™ã‚‹

`devhub.sh` ã¯ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¡¨ç¤ºä»¥å¤–ã«ã‚‚ CLI ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ã‚’å—ã‘ä»˜ã‘ã¾ã™ã€‚

```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆçŠ¶æ³ã ã‘ç¢ºèª
./scripts/devhub/devhub.sh info

# åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚’å®Ÿè¡Œ
./scripts/devhub/devhub.sh setup

# ç”»é¢ãƒ•ãƒ­ãƒ¼å›³ã‚’åˆ¥ã®ãƒ™ãƒ¼ã‚¹ URL ã§ç”Ÿæˆ
./scripts/devhub/devhub.sh flow http://example.com/
```

åˆ©ç”¨å¯èƒ½ãªã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰:

| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ |
| --- | --- |
| `menu` | å¯¾è©±å‹ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‹ã (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ) |
| `info` | Git / Python / Django / ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®çŠ¶æ³ã‚’è¡¨ç¤º |
| `setup` | `scripts/dev_start.sh` ã‚’å®Ÿè¡Œ |
| `start` | `scripts/start_server.sh` ã‚’å®Ÿè¡Œ |
| `ai` | `scripts/ai_generate_spots.sh` ã‚’å®Ÿè¡Œ |
| `flow [URL]` | `flow/generate_flow.py` ã‚’å®Ÿè¡Œ (URL çœç•¥æ™‚ã¯ `http://127.0.0.1:8000/`) |

## ğŸ”§ ç›´æ¥ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ã„ãŸã„å ´åˆ

### é€šå¸¸èµ·å‹• (æ—¢å­˜ç’°å¢ƒã§ã‚µãƒ¼ãƒãƒ¼ã‚’ç«‹ã¡ä¸Šã’)
```bash
./scripts/start_server.sh
```
**æ©Ÿèƒ½**
- ä»®æƒ³ç’°å¢ƒã®æœ‰åŠ¹åŒ–
- Django ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª
- å¿…è¦ã«å¿œã˜ãŸãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
- é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•

### ãƒ•ãƒ«ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— (åˆå›æ¨å¥¨)
```bash
./scripts/dev_start.sh
```
**æ©Ÿèƒ½**
- Python ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ç¢ºèª
- ä»®æƒ³ç’°å¢ƒã®ä½œæˆ (å¿…è¦ãªå ´åˆ)
- pip ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰
- requirements.txt ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- Django ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
- é™çš„ãƒ•ã‚¡ã‚¤ãƒ«åé›†
- é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•

### AI ã‚¹ãƒãƒƒãƒˆç”Ÿæˆ
```bash
./scripts/ai_generate_spots.sh
```
**æ©Ÿèƒ½**
- LM Studio ã®æ¥ç¶šç¢ºèª
- ç”Ÿæˆã‚¹ãƒãƒƒãƒˆæ•°ã®é¸æŠ (5/10/20/ã‚«ã‚¹ã‚¿ãƒ )
- AI ã«ã‚ˆã‚‹è¦³å…‰ã‚¹ãƒãƒƒãƒˆè‡ªå‹•ç”Ÿæˆ
- ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¨é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•

**å‰ææ¡ä»¶**
- LM Studio ãŒèµ·å‹•ã—ã¦ã„ã‚‹
- OpenAI äº’æ› API ãŒæœ‰åŠ¹åŒ–ã•ã‚Œã¦ã„ã‚‹
- ãƒ¢ãƒ‡ãƒ« (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: `qwen/qwen3-4b-2507`) ãŒãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹

## ğŸ—ºï¸ ç”»é¢ãƒ•ãƒ­ãƒ¼å›³ç”Ÿæˆ (Mermaid æ¨å¥¨)

`generate_flow.py` ã¯é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã€Mermaid(.mmd) ã¨ã—ã¦ç”»é¢ãƒ•ãƒ­ãƒ¼å›³ã‚’ç”Ÿæˆã—ã¾ã™ã€‚Mermaid CLI (`mmdc`) ãŒã‚ã‚Œã° SVG/PNG ã‚‚å‡ºåŠ›ã§ãã¾ã™ã€‚Graphviz DOT ã§ã®å‡ºåŠ›ã«ã‚‚åˆ‡ã‚Šæ›¿ãˆå¯èƒ½ã§ã™ã€‚

```bash
# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ã—ãŸçŠ¶æ…‹ã§å®Ÿè¡Œ
python scripts/flow/generate_flow.py --base-url http://127.0.0.1:8000/

# PNG ã§ç”Ÿæˆ
python scripts/flow/generate_flow.py --base-url http://127.0.0.1:8000/ --format png

# å‡ºåŠ›å…ˆ/ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å¤‰æ›´
python scripts/flow/generate_flow.py --base-url http://127.0.0.1:8000/ --outdir scripts/flow/out --filename my_flow

# ãƒ‘ã‚¹ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚° (ä¾‹: /admin, /static, /media ã‚’é™¤å¤– â† ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ)
python scripts/flow/generate_flow.py --base-url http://127.0.0.1:8000/ --exclude "^/(admin|static|media)"

# ã‚¯ãƒ­ãƒ¼ãƒ«ä¸Šé™ã¨ include æ¡ä»¶
python scripts/flow/generate_flow.py --base-url http://127.0.0.1:8000/ --max-pages 80 --include "^/(spots|accounts)"
```

Mermaid CLI ãŒæœªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã®å ´åˆã¯ `.mmd` ã®ã¿å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¾‹:

```bash
npm i -g @mermaid-js/mermaid-cli
```

Graphviz ã‚’ä½¿ã„ãŸã„å ´åˆ (DOT + SVG):

```bash
python scripts/flow/generate_flow.py --engine dot --base-url http://127.0.0.1:8000/
brew install graphviz
```

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚¯ãƒ­ãƒ¼ãƒ«æ¡ä»¶ã¯ `build_default_flow()` ã‚’ç·¨é›†ã™ã‚‹ã“ã¨ã§å¤‰æ›´ã§ãã¾ã™ã€‚

## ğŸ“ ã‚¢ã‚¯ã‚»ã‚¹å…ˆ

- **ãƒ¡ã‚¤ãƒ³ã‚µã‚¤ãƒˆ:** http://127.0.0.1:8000/
- **ç®¡ç†ç”»é¢:** http://127.0.0.1:8000/admin/

## âš ï¸ æ³¨æ„äº‹é …

- ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚
- åˆå›ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ™‚ã¯ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®ã€Œé–‹ç™ºã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã€ã¾ãŸã¯ `setup` ã‚³ãƒãƒ³ãƒ‰ã‚’æ¨å¥¨ã—ã¾ã™ã€‚
- ã‚µãƒ¼ãƒãƒ¼ã‚’åœæ­¢ã™ã‚‹ã«ã¯ `Ctrl+C` ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### æ¨©é™ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹å ´åˆ
```bash
chmod +x start.sh
chmod +x scripts/devhub/devhub.sh
chmod +x scripts/start_server.sh
chmod +x scripts/dev_start.sh
chmod +x scripts/ai_generate_spots.sh
```

### ä»®æƒ³ç’°å¢ƒãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆ
```bash
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

### Django ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„å ´åˆ
```bash
source venv/bin/activate
pip install -r requirements.txt
```

### LM Studio ã®è¨­å®š (AI ã‚¹ãƒãƒƒãƒˆç”Ÿæˆç”¨)

1. **LM Studio ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**: [LM Studio](https://lmstudio.ai/) ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ»ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
2. **ãƒ¢ãƒ‡ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**: ã€Œqwen/qwen3-4b-2507ã€ãªã©ã‚’ãƒ­ãƒ¼ãƒ‰
3. **Local Server ã®èµ·å‹•**: ãƒãƒ¼ãƒˆ 1234 / OpenAI äº’æ› API ã‚’æœ‰åŠ¹åŒ–
4. **ç’°å¢ƒå¤‰æ•° (ä»»æ„)**
   ```bash
   export LMSTUDIO_BASE_URL="http://localhost:1234/v1"
   export LMSTUDIO_MODEL="qwen/qwen3-4b-2507"
   ```
5. **AI ã‚¹ãƒãƒƒãƒˆç”Ÿæˆã‚’å®Ÿè¡Œ**
   ```bash
   ./scripts/devhub/devhub.sh ai
   # ã¾ãŸã¯ ./start.sh â†’ ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€ŒAIã‚¹ãƒãƒƒãƒˆç”Ÿæˆã€
   ```

